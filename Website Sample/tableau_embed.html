<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>Dashboard 1 — Tableau Embed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="color-scheme" content="light dark">
  <style>
    :root {
      --border: #e5e7eb;
      --text: #111827;
      --muted: #6b7280;
      --bg: #ffffff;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        --border: #2d2f31;
        --text: #e5e7eb;
        --muted: #9ca3af;
        --bg: #0b0c0e;
      }
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      color: var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
    }
    .wrap {
      max-width: 1280px;
      margin: 0 auto;
      padding: 20px 16px 40px;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 12px;
    }
    h1 {
      font-size: 18px;
      margin: 0;
      font-weight: 650;
      letter-spacing: .2px;
    }
    .actions {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    .btn {
      appearance: none;
      background: transparent;
      border: 1px solid var(--border);
      padding: 8px 12px;
      border-radius: 10px;
      font-size: 14px;
      text-decoration: none;
      color: var(--text);
      cursor: pointer;
      line-height: 1;
      transition: transform .04s ease, background .2s ease, border-color .2s ease;
    }
    .btn:hover { transform: translateY(-1px); }
    .btn:active { transform: translateY(0); }
    .muted { color: var(--muted); font-size: 13px; margin: 6px 0 16px; }
    .viz-shell {
      width: 100%;
      aspect-ratio: 4 / 3;
      min-height: 420px;
      background: #f8fafc0d;
      border: 1px solid var(--border);
      border-radius: 14px;
      overflow: hidden;
      position: relative;
    }
    .tableauPlaceholder .tableauViz {
      width: 100%;
      height: 100%;
      display: block;
    }
    footer {
      margin-top: 18px;
      color: var(--muted);
      font-size: 12px;
    }
    noscript img {
      max-width: 100%;
      height: auto;
      display: block;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Dashboard 1</h1>
      <div class="actions">
        <a class="btn" id="open-newtab" href="https://public.tableau.com/views/NewYorker01/Dashboard1?:language=zh-TW&:display_count=y&publish=yes" target="_blank" rel="noopener">在新標籤中打開</a>
        <button class="btn" id="btn-fullscreen" type="button">全螢幕</button>
      </div>
    </header>
    <p class="muted">嵌入自 Tableau Public · 來源：<a href="https://public.tableau.com/views/NewYorker01/Dashboard1" target="_blank" rel="noopener">NewYorker01 / Dashboard1</a></p>

    <div class="tableauPlaceholder viz-shell" id="viz-nyer-01" role="region" aria-label="Tableau Dashboard: NewYorker01 / Dashboard1">
      <noscript>
        <a href="https://public.tableau.com/views/NewYorker01/Dashboard1?:language=zh-TW&:display_count=y&publish=yes" target="_blank" rel="noopener">
          <img alt="Dashboard 1 預覽圖" src="https://public.tableau.com/static/images/Ne/NewYorker01/Dashboard1/1.png" />
        </a>
      </noscript>

      <object class="tableauViz">
        <param name="host_url" value="https%3A%2F%2Fpublic.tableau.com%2F" />
        <param name="embed_code_version" value="3" />
        <param name="site_root" value="" />
        <param name="name" value="NewYorker01/Dashboard1" />
        <param name="tabs" value="no" />
        <param name="toolbar" value="no" />
        <param name="static_image" value="https://public.tableau.com/static/images/Ne/NewYorker01/Dashboard1/1.png" />
        <param name="animate_transition" value="yes" />
        <param name="display_static_image" value="yes" />
        <param name="display_spinner" value="yes" />
        <param name="display_overlay" value="yes" />
        <param name="display_count" value="yes" />
        <param name="language" value="zh-TW" />
        <param name="filter" value="publish=yes" />
        <param name="showShareOptions" value="false" />
        <param name="customViews" value="no" />
        <param name="tooltip" value="yes" />
      </object>
    </div>

    <footer>
      若要顯示工具列或分頁，請將 <code>toolbar</code> 或 <code>tabs</code> 的值改為 <code>yes</code>。
    </footer>
  </div>

  <script>
    (function () {
      var divElement = document.getElementById('viz-nyer-01');
      var vizElement = divElement.getElementsByTagName('object')[0];

      // aspect-ratio 後備：對老舊瀏覽器以 4:3 設定高度
      if (!CSS.supports || !CSS.supports('aspect-ratio', '4 / 3')) {
        function sizeFallback() {
          vizElement.style.width = '100%';
          vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
        }
        sizeFallback();
        window.addEventListener('resize', sizeFallback);
      }

      // 加載 Tableau API（若尚未存在）
      function ensureApiAndInit() {
        if (window.tableau) return initViz();
        var script = document.createElement('script');
        script.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
        script.onload = initViz;
        vizElement.parentNode.insertBefore(script, vizElement);
      }

      function initViz() {
        // 舊式 object 方式由 API 自動激活，這裡無需額外代碼
      }

      ensureApiAndInit();

      // 全屏切換
      var fsBtn = document.getElementById('btn-fullscreen');
      fsBtn.addEventListener('click', function () {
        var el = divElement;
        var doc = document;
        if (!doc.fullscreenElement && el.requestFullscreen) {
          el.requestFullscreen();
        } else if (doc.exitFullscreen) {
          doc.exitFullscreen();
        }
      });
    })();
  </script>
</body>
</html>
